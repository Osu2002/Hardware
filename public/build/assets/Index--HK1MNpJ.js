import{d as c,P as l,m as u,p as r,q as n,s as t,x as f,M as m,t as y,J as k}from"./index-BC79lHc5.js";import{A as g}from"./AppLayout-DiJY6Gaj.js";import{D as x}from"./DataTable-C3Ue-IAF.js";import{_ as v}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C45j6faE.js";const w={components:{Link:c.Link,AppLayout:g,DataTable:x},data(){return{countriesCount:0,columns:[{data:"check",name:"check",orderable:!1,searchable:!1},{data:"name",name:"name",orderable:!0,searchable:!0},{data:"status",name:"status",orderable:!0},{data:"image",name:"image",orderable:!1,searchable:!0},{data:"action",name:"action",orderable:!0}],columnDefs:[{className:"text-center",targets:[]}],order:[[1,"desc"]],form:c.useForm({id:"",status:""})}},computed:{canCreate(){return this.$root.hasPermission("country.create")&&this.countriesCount<5}},mounted(){$("#mytable").on("draw.dt",()=>{const s=$("#mytable").DataTable().page.info();this.countriesCount=s.recordsTotal}),$("#mytable tbody").on("click","tr .action_delete",s=>{const e=$(s.target).data("item-id");this.selectedRows=[],this.getSelectedItems(e)}),$("#mytable tbody").on("click","tr .action_edit",s=>{const e=$(s.target).data("item-id");this.$inertia.visit(route("country.edit",e))}),$("#mytable tbody").on("click","tr .action_status_change",s=>{const e=$(s.target).data("item-id"),d=$(s.target).data("status");this.updateStatus(e,d)}),$("#mytable tbody").on("click",".item-check input[type=checkbox]",s=>{const e=$(s.target).val();$(s.target).prop("checked")&&!this.selectedRows.includes(e)?this.getSelectedItems(e):this.removeUnselectedItem(e)})},methods:{reloadTable(){this.$refs.datatable.reloadDatatable()},getSelectedItems(s){this.selectedRows.push(s),this.selectedRows.length>0&&(this.$data.isDisabled=!1)},selectAll(s){var e=this;$(s.target).is(":checked")?($(".item-check input[type=checkbox]").prop("checked",!0),$(".item-check input[type=checkbox]:checked").each(function(){e.selectedRows.includes(this.value)||e.getSelectedItems(this.value)}),this.$data.isDisabled=!1):($(".item-check input[type=checkbox]").prop("checked",!1),$(".item-check input[type=checkbox]").each(function(){e.selectedRows.includes(this.value)&&e.removeUnselectedItem(this.value)}),this.$data.isDisabled=!0)},removeUnselectedItem(s){this.selectedRows=this.selectedRows.filter(function(e){return e!=s}),this.selectedRows.length<=0&&($("#selectAll").prop("checked",!1),this.$data.isDisabled=!0)},updateStatus(s,e){this.form.id=s,this.form.status=e,this.form.put(route("country.change.status"),{preserveScroll:!0,onSuccess:()=>{this.form.reset(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Staus Updated Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})},deleteSelectedItems(){this.form.transform(s=>({...s,ids:[...this.selectedRows]})).post(route("country.delete"),{onSuccess:()=>{this.resetForm(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")},onFinish:()=>{$("#deleteConfirm").modal("hide"),this.resetForm()}})},resetForm(){this.form.reset("id","status")}}},S={class:"row"},C={class:"col-md-12"},_={class:"card mb-4"},A={class:"card-header pb-0"},D={class:"d-flex"},I={key:1,class:"btn btn-main btn-sm",disabled:""},R={class:"card-body"},F={width:"10%"},L={class:"custom-control custom-checkbox"},M={class:"modal modal-top fade",id:"deleteConfirm",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"false"},T={class:"modal-dialog modal-sm",role:"document"},E={class:"modal-content"},B={class:"modal-footer px-3 pb-3"};function N(s,e,d,U,i,o){const h=l("Link"),b=l("data-table"),p=l("AppLayout");return r(),u(p,null,{default:n(()=>[t("div",S,[t("div",C,[t("div",_,[t("div",A,[e[5]||(e[5]=t("h5",null,"Countries",-1)),e[6]||(e[6]=t("p",null,"Manage Countries.",-1)),t("div",D,[o.canCreate?(r(),u(h,{key:0,class:"btn btn-main btn-sm",href:s.route("country.create")},{default:n(()=>e[3]||(e[3]=[t("i",{class:"bx bx-plus"},null,-1),m(" Create ")])),_:1},8,["href"])):(r(),f("button",I,e[4]||(e[4]=[t("i",{class:"bx bx-plus"},null,-1),m(" Create ")])))])]),t("div",R,[y(b,{ref:"datatable",id:"mytable",url:s.route("country.getdata"),columns:i.columns,columnDefs:i.columnDefs},{header:n(()=>[t("tr",null,[t("th",F,[t("div",L,[t("input",{type:"checkbox",class:"form-check-input",id:"selectAll",onClick:e[0]||(e[0]=a=>o.selectAll(a))}),e[7]||(e[7]=t("label",{class:"form-check-label",for:"selectAll"},null,-1))])]),e[8]||(e[8]=t("th",null,"Country",-1)),e[9]||(e[9]=t("th",null,"Status",-1)),e[10]||(e[10]=t("th",null,"Flag",-1)),e[11]||(e[11]=t("th",null,"Action",-1))])]),_:1},8,["url","columns","columnDefs"])])])]),t("div",M,[t("div",T,[t("div",E,[e[14]||(e[14]=t("div",{class:"modal-header px-3 pb-2"},[t("h5",{class:"modal-title",id:"exampleModalLabel2"}," Are You Sure? ")],-1)),t("form",{id:"formAccountDelete",onSubmit:e[2]||(e[2]=k((...a)=>o.deleteSelectedItems&&o.deleteSelectedItems(...a),["prevent"]))},[e[13]||(e[13]=t("div",{class:"modal-body py-0 px-3"},[t("div",{class:"row"},[t("div",{class:"col mb-1"},[t("p",null,"Are you sure you want to delete?")])])],-1)),t("div",B,[t("button",{type:"button",class:"btn btn-sm btn-label-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...a)=>o.resetForm&&o.resetForm(...a))}," Close "),e[12]||(e[12]=t("button",{type:"submit",class:"btn btn-sm btn-primary"}," Yes ",-1))])],32)])])])])]),_:1})}const W=v(w,[["render",N]]);export{W as default};
