import{d as M,P as m,x as l,p as c,t as h,s,q as $,M as F,L as d,F as u,N as A,O as B,E as w,J as S}from"./index-BC79lHc5.js";import N from"./Types-CYXEHjHU.js";import P from"./Manufactures-Ch38KvqZ.js";import E from"./Models-DTqafDpX.js";import q from"./Countries-Cx02hNkg.js";import O from"./Banner-BuUUrtxn.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={updated(){this.$nextTick(()=>{const t=this.$refs.filterBox,e=t==null?void 0:t.style.position;(e==="fixed"||e==="absolute")&&this.handleSticky()})},components:{Banner:O,Types:N,Manufactures:P,Models:E,Countries:q,Link:M.Link},data(){return{sortBy:this.$page.props.requestQuery.sortBy||"",keyword:this.$page.props.requestQuery.keyword||"",isLoading:!1,imageLoaded:{}}},computed:{selectedCountry(){return this.$page.props.selectedCountry||null},getSelectedTypes(){var o;const t=((o=this.$page.props.requestQuery)==null?void 0:o.type)||[];return(Array.isArray(t)?t:[t]).map(i=>{const n=this.$page.props.vehicleTypes.find(r=>r.id===parseInt(i));return n?n.title:""}).filter(Boolean)},getSelectedMakes(){var o;const t=((o=this.$page.props.requestQuery)==null?void 0:o.brand)||[];return(Array.isArray(t)?t:[t]).map(i=>{const n=this.$page.props.manufacturers.find(r=>r.id===parseInt(i));return n?n.title:""}).filter(Boolean)},getSelectedModels(){var o;const t=((o=this.$page.props.requestQuery)==null?void 0:o.model)||[];return(Array.isArray(t)?t:[t]).map(i=>{const n=this.$page.props.models.find(r=>r.id===parseInt(i));return n?n.title:""}).filter(Boolean)},getSelectedCountries(){var o;const t=((o=this.$page.props.requestQuery)==null?void 0:o.country)||[];return(Array.isArray(t)?t:[t]).map(i=>{const n=this.$page.props.countries.find(r=>r.id===parseInt(i));return n?n.name:""}).filter(Boolean)},visiblePages(){const t=this.$page.props.vehicles,e=t.last_page,o=t.current_page;let i=o-1,n=o+1;i<1&&(i=1,n=Math.min(3,e)),n>e&&(n=e,i=Math.max(e-2,1));const r=[];for(let g=i;g<=n;g++)r.push(g);return r}},mounted(){window.addEventListener("scroll",this.handleSticky),window.addEventListener("resize",this.handleSticky)},beforeUnmount(){window.removeEventListener("scroll",this.handleSticky),window.removeEventListener("resize",this.handleSticky)},methods:{parseGrades(t){try{return Array.isArray(t)?t:JSON.parse(t||"[]")}catch{return[]}},rawList(t){if(t==null)return"";if(Array.isArray(t))return t.join(", ");const e=String(t).trim();if(!e)return"";try{const o=JSON.parse(e);return Array.isArray(o)?o.join(", "):e}catch{return e}},getFirstGrade(t){const e=this.parseGrades(t.grades);return e.length?e[0]:{}},parseList(t){if(Array.isArray(t))return t;if(t&&typeof t=="object")return[t];try{const e=JSON.parse(t);return Array.isArray(e)?e:[e]}catch{return[]}},getMinCapacity(t){const e=this.parseList(t).map(Number).filter(o=>!isNaN(o)).sort((o,i)=>o-i);return e.length?e[0]:""},getFuelSummary(t){const o=this.parseList(t).map(i=>i&&i.name?i.name:i);return o.length===0?"":o.length===1?o[0]:`${o[0]} +${o.length-1} `},markLoaded(t){this.imageLoaded[t]=!0},handleSticky(){window.requestAnimationFrame(()=>{const e=this.$refs.filterColumn,o=this.$refs.filterBox;if(!e||!o)return;if(window.innerWidth<992){o.style.position="",o.style.top="",o.style.left="",o.style.width="";return}const i=e.getBoundingClientRect(),n=getComputedStyle(e),r=parseFloat(n.paddingLeft),g=parseFloat(n.paddingRight),f=i.top+window.pageYOffset,_=e.offsetHeight,b=i.width-r-g,x=i.left+r,v=o.offsetHeight,a=window.pageYOffset||window.scrollY,y=f-80,k=f+_-v-80;if(a<y)o.style.position="",o.style.top="",o.style.left="",o.style.width="";else if(a>k){o.style.position="absolute",o.style.top=_-v+"px";const p=b;o.style.width=p+"px";const L=parseFloat(getComputedStyle(o).maxWidth),C=Math.min(p,L),T=(p-C)/2;o.style.left=r+T+"px"}else{o.style.position="fixed",o.style.top="80px";const p=b;o.style.width=p+"px";const L=parseFloat(getComputedStyle(o).maxWidth),C=Math.min(p,L),T=(p-C)/2;o.style.left=x+T+"px"}})},handleScroll(){const t=window.scrollY,e=this.$refs.filterSidebar.offsetTop;this.isSticky=t>e},search(){this.isLoading=!0,this.$inertia.reload({method:"POST",data:{_method:"GET",keyword:this.keyword},onFinish:()=>this.isLoading=!1})},clearSearch(){this.keyword="",this.isLoading=!0,this.$inertia.visit("/available-cars",{method:"get",onFinish:()=>this.isLoading=!1})},applySort(){this.isLoading=!0,this.$inertia.reload({method:"POST",data:{_method:"GET",sortBy:this.sortBy},onFinish:()=>this.isLoading=!1})},formatPrice(t){return Number(t).toLocaleString()},getExColor(t){const e=this.$page.props.vehicleTypes.find(o=>o.id===t);return e?e.title:""},changePage(t){if(t<1||t>this.$page.props.vehicles.last_page)return;const e=this.$refs.cardsSection;e&&e.getBoundingClientRect().top+window.pageYOffset-80,this.isLoading=!0,this.$inertia.reload({data:{...this.$page.props.requestQuery,page:t},preserveState:!0,preserveScroll:!0,onFinish:()=>{this.isLoading=!1}})}}},H={class:"container-fluid px-4 px-lg-5 mt-5 mb-5"},V={class:"row gx-4 align-items-stretch"},W={class:"col-12 col-lg-3 filter-column mb-5 mb-lg-0 pe-lg-4",ref:"filterColumn"},Y={class:"filter-background",ref:"filterBox"},Q={class:"p-3 filter-sidebar"},R={class:"card-body"},I={class:"mb-4"},J={class:"accordion",id:"accordionExample"},z={class:"accordion-item border-0 mb-3"},U={class:"accordion-header"},D={class:"accordion-button collapsed rounded",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseTwo","aria-expanded":"true","aria-controls":"collapseTwo"},K={id:"collapseTwo",class:"accordion-collapse collapse show","data-bs-parent":"#accordionExample"},X={class:"accordion-body"},Z={class:"accordion-item border-0 mb-3"},ee={class:"accordion-header"},te={class:"accordion-button collapsed rounded",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseThree","aria-expanded":"false","aria-controls":"collapseThree"},se={id:"collapseThree",class:"accordion-collapse collapse","data-bs-parent":"#accordionExample"},oe={class:"accordion-body"},re={class:"accordion-item border-0 mb-3"},ae={class:"accordion-header"},ie={class:"accordion-button collapsed rounded",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"false","aria-controls":"collapseOne"},ne={id:"collapseOne",class:"accordion-collapse collapse","data-bs-parent":"#accordionExample"},le={class:"accordion-body"},ce={class:"accordion-item border-0 mb-3"},de={class:"accordion-header"},pe={class:"accordion-button collapsed rounded",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseFour","aria-expanded":"false","aria-controls":"collapseFour"},ue={id:"collapseFour",class:"accordion-collapse collapse","data-bs-parent":"#accordionExample"},ge={class:"accordion-body"},me={class:"col-12 col-lg-9 ps-lg-4"},he={key:0,class:"text-center"},ye={ref:"cardsSection"},fe={key:0,class:"row row-cols-1 row-cols-md-2 row-cols-lg-2 row-cols-xl-3 g-4"},_e=["href"],be={class:"car-card h-100"},ve={class:"card-image position-relative"},ke={key:0,class:"skeleton-placeholder"},we=["src","onLoad"],Se={class:"year-pill"},xe={class:"image-counter"},Le={class:"card-details"},Ce={class:"car-title"},Te={class:"specs"},Ae={key:0,class:"spec-item"},Fe={class:"spec-text"},Be={key:1,class:"spec-item"},Me={class:"spec-text"},$e={key:2,class:"spec-item"},Ne={class:"spec-text"},Pe={class:"card-footer"},Ee={class:"price-wrapper text-center"},qe={class:"d-flex flex-column align-items-start"},Oe={class:"price fs-4 fw-bold"},Ge={key:1,class:"text-center"},je={key:1,class:"d-flex justify-content-center justify-content-lg-end mt-4 pagination-wrapper"},He={"aria-label":"Page navigation"},Ve={class:"pagination mb-0"},We={key:0,class:"page-item disabled"},Ye=["onClick"],Qe={key:1,class:"page-item disabled"};function Re(t,e,o,i,n,r){const g=m("Banner"),f=m("bolt"),_=m("Manufactures"),b=m("Models"),x=m("Types"),v=m("Countries");return c(),l(A,null,[h(g,{"selected-country":r.selectedCountry},null,8,["selected-country"]),s("div",H,[s("div",V,[s("div",W,[s("div",Y,[s("div",Q,[s("div",R,[s("h2",I,[h(f,null,{default:$(()=>e[3]||(e[3]=[F("Filter By")])),_:1})]),s("div",J,[e[4]||(e[4]=s("div",{class:"filter-label"},"Make",-1)),s("div",z,[s("h2",U,[s("button",D,d(r.getSelectedMakes.length?r.getSelectedMakes.join(", "):"Select.."),1)]),s("div",K,[s("div",X,[h(_)])])]),e[5]||(e[5]=s("div",{class:"filter-label"},"Model",-1)),s("div",Z,[s("h2",ee,[s("button",te,d(r.getSelectedModels.length?r.getSelectedModels.join(", "):"Select.."),1)]),s("div",se,[s("div",oe,[h(b)])])]),e[6]||(e[6]=s("div",{class:"filter-label"},"Type",-1)),s("div",re,[s("h2",ae,[s("button",ie,d(r.getSelectedTypes.length?r.getSelectedTypes.join(", "):"Select.."),1)]),s("div",ne,[s("div",le,[h(x)])])]),e[7]||(e[7]=s("div",{class:"filter-label"},"Country",-1)),s("div",ce,[s("h2",de,[s("button",pe,d(r.getSelectedCountries.length?r.getSelectedCountries.join(", "):"Select.."),1)]),s("div",ue,[s("div",ge,[h(v,{countries:t.$page.props.countries},null,8,["countries"])])])])])])])],512)],512),s("div",me,[n.isLoading?(c(),l("div",he,e[8]||(e[8]=[s("p",null,"Loading vehiclesâ€¦",-1)]))):u("",!0),s("div",ye,[t.$page.props.vehicles&&t.$page.props.vehicles.data.length?(c(),l("div",fe,[(c(!0),l(A,null,B(t.$page.props.vehicles.data,a=>{var y,k;return c(),l("div",{class:"col d-flex justify-content-center",key:a.id},[s("a",{href:t.route("product",{model:t.$root.stringToSlug(a.manufacture.title),slug:t.$root.stringToSlug(a.manufacture.title)+"-"+t.$root.stringToSlug(a.vehicle_model.title),id:a.id}),class:"w-100 text-decoration-none"},[s("div",be,[s("div",ve,[n.imageLoaded[a.id]?u("",!0):(c(),l("div",ke)),s("img",{src:(y=a.media[0])==null?void 0:y.original_url,alt:"car",class:w(["auction-image",{"is-loaded":n.imageLoaded[a.id]}]),onLoad:p=>r.markLoaded(a.id)},null,42,we),s("span",Se,d(a.year),1),s("span",{class:"bookmark-icon",onClick:e[0]||(e[0]=S(()=>{},["stop"]))},e[9]||(e[9]=[s("img",{src:"/images/bookmark.png",alt:"Bookmark",class:"bookmark-img"},null,-1)])),s("span",xe,[e[10]||(e[10]=s("img",{src:"/images/image.png",alt:"Photos",class:"counter-icon"},null,-1)),F(" "+d(((k=a.media)==null?void 0:k.length)||0),1)])]),s("div",Le,[s("h5",Ce,d(a.manufacture.title)+" "+d(a.vehicle_model.title),1),s("div",Te,[r.parseGrades(a.grades).length||a.engine_capacity?(c(),l("div",Ae,[e[11]||(e[11]=s("img",{src:"/images/car-engine.png",alt:"Engine",class:"spec-icon"},null,-1)),s("div",Fe,d(r.rawList(r.getFirstGrade(a).engine_capacities)||a.engine_capacity||"â€“"),1)])):u("",!0),r.parseGrades(a.grades).length?(c(),l("div",Be,[e[12]||(e[12]=s("img",{src:"/images/gasoline-pump.png",alt:"Fuel",class:"spec-icon"},null,-1)),s("div",Me,d(r.getFuelSummary(r.getFirstGrade(a).fuel_types)),1)])):u("",!0),r.parseGrades(a.grades).length?(c(),l("div",$e,[e[13]||(e[13]=s("img",{src:"/images/gearbox.png",alt:"Transmission",class:"spec-icon"},null,-1)),s("div",Ne,d(r.getFirstGrade(a).transmission||"â€“"),1)])):u("",!0)]),s("div",Pe,[s("div",Ee,[s("div",qe,[e[14]||(e[14]=s("small",{class:"text-muted mb-1"},"Upwards",-1)),s("div",Oe,d(a.monthly_price_currency==="USD"?"$":"LKR ")+" "+d(r.formatPrice(a.monthly_price)),1)])])])])])],8,_e)])}),128))])):(c(),l("div",Ge,e[15]||(e[15]=[s("p",null,"No vehicles found matching your filters.",-1)])))],512),t.$page.props.vehicles.last_page>1?(c(),l("div",je,[s("nav",He,[s("ul",Ve,[s("li",{class:w(["page-item",{disabled:!t.$page.props.vehicles.prev_page_url}])},[s("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=S(a=>r.changePage(t.$page.props.vehicles.current_page-1),["prevent"]))}," Previous ")],2),r.visiblePages[0]>1?(c(),l("li",We,e[16]||(e[16]=[s("span",{class:"page-link"},"â€¦",-1)]))):u("",!0),(c(!0),l(A,null,B(r.visiblePages,a=>(c(),l("li",{class:w(["page-item",{active:t.$page.props.vehicles.current_page===a}]),key:a},[s("a",{class:"page-link",href:"#",onClick:S(y=>r.changePage(a),["prevent"])},d(a),9,Ye)],2))),128)),r.visiblePages[r.visiblePages.length-1]<t.$page.props.vehicles.last_page?(c(),l("li",Qe,e[17]||(e[17]=[s("span",{class:"page-link"},"â€¦",-1)]))):u("",!0),s("li",{class:w(["page-item",{disabled:!t.$page.props.vehicles.next_page_url}])},[s("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=S(a=>r.changePage(t.$page.props.vehicles.current_page+1),["prevent"]))}," Next ")],2)])])])):u("",!0)])])])],64)}const Ze=G(j,[["render",Re],["__scopeId","data-v-bb7fb4c7"]]);export{Ze as default};
