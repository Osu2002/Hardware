import{d as k,P as L,x as l,p as o,s as r,t as b,q as _,N as w,O as T,m as P,F as g,E as S,L as n,J as N,M as v,T as x}from"./index-BC79lHc5.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={name:"FeaturedListings",components:{Link:k.Link},props:{featuredVehicles:{type:Array,default:()=>[]}},data(){return{activeTab:"inStock",page:0,perPageDesktop:4,transitionName:"slide-left",width:0,imageLoaded:{}}},computed:{perPage(){return this.width<576?1:this.width<1050?6:this.width<1800?8:this.perPageDesktop},filtered(){if(this.activeTab==="inStock")return this.featuredVehicles;if(this.activeTab==="newCars")return this.featuredVehicles.filter(s=>s.vehicle_status==="new");if(this.activeTab==="usedCars")return this.featuredVehicles.filter(s=>s.vehicle_status==="used")},currentPageItems(){const s=this.page*this.perPage;return this.filtered.slice(s,s+this.perPage)}},methods:{rawList(s){if(s==null)return"";if(Array.isArray(s))return s.join(", ");const e=String(s).trim();if(!e)return"";try{const i=JSON.parse(e);return Array.isArray(i)?i.join(", "):e}catch{return e}},parseGrades(s){try{return Array.isArray(s)?s:JSON.parse(s||"[]")}catch{return[]}},getFirstGrade(s){const e=this.parseGrades(s.grades);return e.length?e[0]:{}},parseList(s){if(Array.isArray(s))return s;if(s&&typeof s=="object")return[s];try{const e=JSON.parse(s);return Array.isArray(e)?e:[e]}catch{return[]}},getMinCapacity(s){const e=this.parseList(s).map(Number).filter(i=>!isNaN(i)).sort((i,d)=>i-d);return e.length?e[0]:""},getFuelSummary(s){const i=this.parseList(s).map(d=>d&&d.name?d.name:d);return i.length===0?"":i.length===1?i[0]:`${i[0]} +${i.length-1} `},switchTab(s){this.activeTab=s,this.page=0},prevPage(){this.page>0&&(this.transitionName="slide-right"),this.page--},nextPage(){(this.page+1)*this.perPage<this.filtered.length&&(this.transitionName="slide-left",this.page++)},onResize(){this.width=window.innerWidth,this.page=0},onTouchStart(s){this.touchStartX=s.changedTouches[0].clientX},onTouchEnd(s){const e=s.changedTouches[0].clientX-this.touchStartX;e<-50?this.nextPage():e>50&&this.prevPage()},markLoaded(s){this.imageLoaded[s]=!0}},mounted(){this.onResize(),window.addEventListener("resize",this.onResize)},beforeUnmount(){window.removeEventListener("resize",this.onResize)}},A={class:"featured-listings container px-3 px-md-5"},G={class:"card-image position-relative"},E={key:0,class:"skeleton-placeholder"},V=["src","alt","onLoad"],z={class:"year-pill"},B={class:"image-counter"},R={class:"card-details"},j={class:"car-title"},D={class:"car-subtitle"},I={class:"specs"},J={key:0,class:"spec-item"},O={key:0,class:"spec-item"},X={class:"spec-text"},M={key:1,class:"spec-item"},U={class:"spec-text"},q={key:2,class:"spec-item"},K={class:"spec-text"},W={class:"card-footer"},H={class:"price"},Q={class:"pager"},Y=["disabled"],Z=["disabled"];function $(s,e,i,d,c,a){const y=L("Link");return o(),l("section",A,[e[13]||(e[13]=r("div",{class:"d-flex justify-content-between align-items-center mb-4"},[r("h2",{class:"fw-bold mb-0"},"Featured Listings")],-1)),b(x,{name:c.transitionName,mode:"out-in"},{default:_(()=>[(o(),l("div",{key:c.page,class:"grid",onTouchstart:e[1]||(e[1]=(...t)=>a.onTouchStart&&a.onTouchStart(...t)),onTouchend:e[2]||(e[2]=(...t)=>a.onTouchEnd&&a.onTouchEnd(...t))},[(o(!0),l(w,null,T(a.currentPageItems,t=>(o(),P(y,{key:t.id,href:s.route("product",{model:s.$root.stringToSlug(t.manufacture.title),slug:s.$root.stringToSlug(t.manufacture.title)+"-"+s.$root.stringToSlug(t.vehicle_model.title),id:t.id}),class:"car-card text-decoration-none"},{default:_(()=>{var u,h,p,m,f;return[r("div",G,[c.imageLoaded[t.id]?g("",!0):(o(),l("div",E)),r("img",{src:((h=(u=t.media)==null?void 0:u[0])==null?void 0:h.original_url)||"/placeholder.png",alt:((p=t.vehicle_model)==null?void 0:p.name)||"Vehicle Image",class:S(["img-fluid auction-image",{"is-loaded":c.imageLoaded[t.id]}]),onLoad:ee=>a.markLoaded(t.id)},null,42,V),r("span",z,n(t.year),1),r("span",{class:"bookmark-icon",onClick:e[0]||(e[0]=N(()=>{},["stop"]))},e[5]||(e[5]=[r("img",{src:"/images/bookmark.png",alt:"Bookmark",class:"bookmark-img"},null,-1)])),r("span",B,[e[6]||(e[6]=r("img",{src:"/images/image.png",alt:"Photos",class:"counter-icon"},null,-1)),v(" "+n(((m=t.media)==null?void 0:m.length)||0),1)])]),r("div",R,[r("h5",j,n(t.manufacture.title)+" "+n(t.vehicle_model.title),1),r("p",D,n((f=t.vehicle_type)==null?void 0:f.title),1),r("div",I,[a.parseGrades(t.grades).length?(o(),l("div",J,[e[7]||(e[7]=r("img",{src:"/images/car-engine.png",alt:"Engine CC",class:"spec-icon"},null,-1)),a.parseGrades(t.grades).length||t.engine_capacity?(o(),l("div",O,[r("div",X,n(a.rawList(a.getFirstGrade(t).engine_capacities)||t.engine_capacity||"–"),1)])):g("",!0)])):g("",!0),a.parseGrades(t.grades).length?(o(),l("div",M,[e[8]||(e[8]=r("img",{src:"/images/gasoline-pump.png",alt:"Fuel",class:"spec-icon"},null,-1)),r("div",U,n(a.getFuelSummary(a.getFirstGrade(t).fuel_types)),1)])):g("",!0),a.parseGrades(t.grades).length?(o(),l("div",q,[e[9]||(e[9]=r("img",{src:"/images/gearbox.png",alt:"Transmission",class:"spec-icon"},null,-1)),r("div",K,n(a.getFirstGrade(t).transmission||"–"),1)])):g("",!0)]),r("div",W,[r("div",H,[e[10]||(e[10]=r("small",{class:"upwards-label"},"Upwards",-1)),v(" "+n(t.monthly_price_currency==="USD"?"$":"LKR ")+" "+n((t.monthly_price||0).toLocaleString()),1)])])])]}),_:2},1032,["href"]))),128))],32))]),_:1},8,["name"]),r("div",Q,[r("button",{onClick:e[3]||(e[3]=(...t)=>a.prevPage&&a.prevPage(...t)),disabled:c.page===0},e[11]||(e[11]=[r("i",{class:"fas fa-chevron-left"},null,-1)]),8,Y),r("button",{onClick:e[4]||(e[4]=(...t)=>a.nextPage&&a.nextPage(...t)),disabled:(c.page+1)*a.perPage>=a.filtered.length},e[12]||(e[12]=[r("i",{class:"fas fa-chevron-right"},null,-1)]),8,Z)])])}const re=C(F,[["render",$],["__scopeId","data-v-a203ae0c"]]);export{re as default};
