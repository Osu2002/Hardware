import{d as z,P as m,m as G,p as i,q as c,s as t,F as tt,M as W,t as et,J as st,x as u,N as H,O as K,L as d}from"./index-BC79lHc5.js";import{A as lt}from"./AppLayout-DiJY6Gaj.js";import{D as at}from"./DataTable-C3Ue-IAF.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C45j6faE.js";const ot={components:{Link:z.Link,AppLayout:lt,DataTable:at},data(){return{columns:[{data:"check",name:"check",orderable:!1,searchable:!1},{data:"name",name:"name",orderable:!0,searchable:!0},{data:"email",name:"email",orderable:!0,searchable:!0},{data:"phone",name:"phone",orderable:!0,searchable:!0},{data:"status",name:"status",orderable:!0},{data:"action",name:"action",orderable:!0}],columnDefs:[{className:"text-center",targets:[]}],order:[[1,"desc"]],form:z.useForm({id:"",status:""}),lead_data:""}},mounted(){$("#mytable tbody").on("click","tr .action_delete",s=>{const e=$(s.target).data("item-id");this.selectedRows=[],this.getSelectedItems(e)}),$("#mytable tbody").on("click","tr .action_edit",s=>{const e=$(s.target).data("item-id");this.$inertia.visit(route("lead.edit",e))}),$("#mytable tbody").on("click","tr .action_view",s=>{const e=$(s.target).data("item-id"),n=this;$.ajax({url:route("lead.itemdata"),type:"GET",data:{id:e},success:function(r){let l=JSON.parse(r.lead.vehicle_data),o=JSON.parse(r.lead.status_data);n.lead_data=r,n.lead_data.lead.vehicle_data=l,n.lead_data.lead.status_data=o,console.log(r),$("#viewModal").modal("show")},error:function(){alert("Failed to fetch data.")}})}),$("#mytable tbody").on("click","tr .action_status_change",s=>{const e=$(s.target).data("item-id"),n=$(s.target).data("status");this.updateStatus(e,n)}),$("#mytable tbody").on("click",".item-check input[type=checkbox]",s=>{const e=$(s.target).val();$(s.target).prop("checked")&&!this.selectedRows.includes(e)?this.getSelectedItems(e):this.removeUnselectedItem(e)})},methods:{reloadTable(){this.$refs.datatable.reloadDatatable()},getSelectedItems(s){this.selectedRows.push(s),this.selectedRows.length>0&&(this.$data.isDisabled=!1)},selectAll(s){var e=this;$(s.target).is(":checked")?($(".item-check input[type=checkbox]").prop("checked",!0),$(".item-check input[type=checkbox]:checked").each(function(){e.selectedRows.includes(this.value)||e.getSelectedItems(this.value)}),this.$data.isDisabled=!1):($(".item-check input[type=checkbox]").prop("checked",!1),$(".item-check input[type=checkbox]").each(function(){e.selectedRows.includes(this.value)&&e.removeUnselectedItem(this.value)}),this.$data.isDisabled=!0)},removeUnselectedItem(s){this.selectedRows=this.selectedRows.filter(function(e){return e!=s}),this.selectedRows.length<=0&&($("#selectAll").prop("checked",!1),this.$data.isDisabled=!0)},updateStatus(s,e){this.form.id=s,this.form.status=e,this.form.put(route("lead.status.update"),{preserveScroll:!0,onSuccess:()=>{this.form.reset(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Staus Updated Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})},deleteSelectedItems(){this.form.transform(s=>({...s,ids:[...this.selectedRows]})).post(route("lead.delete"),{onSuccess:()=>{this.resetForm(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")},onFinish:()=>{$("#deleteConfirm").modal("hide"),this.resetForm()}})},resetForm(){this.form.reset("id","status")}}},nt={class:"row"},it={class:"col-md-12"},rt={class:"card mb-4"},ut={class:"card-header pb-0"},mt={class:"d-flex"},ct={class:"card-body"},pt={width:"10%"},ht={class:"custom-control custom-checkbox"},bt={class:"modal modal-top fade",id:"deleteConfirm",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"false"},_t={class:"modal-dialog modal-sm",role:"document"},ft={class:"modal-content"},gt={class:"modal-footer px-3 pb-3"},vt={class:"modal fade",id:"viewModal",tabindex:"-1","aria-labelledby":"viewModalLabel","aria-hidden":"true"},yt={class:"modal-dialog modal-lg"},kt={class:"modal-content"},wt={class:"modal-body"},St={class:"row g-3"},xt={class:"col-md-12"},At={class:"table"},Ct=["href"],Lt={class:"col-md-6"},Mt={id:"modal-item-name"},Nt={class:"col-md-6"},$t={id:"modal-item-email"},Rt={class:"col-md-6"},It={id:"modal-item-phone"},Dt={class:"col-md-6"},Ft={id:"modal-item-address"},Pt={class:"col-md-6"},Et={id:"modal-item-message"},Tt={class:"col-md-6"},Ut={id:"modal-item-purchase_time"},Vt={class:"col-md-6"},Bt={id:"modal-item-payment_method"},Jt={class:"col-md-6"},Ot={id:"modal-item-dealer_id"},Yt={class:"col-md-6"},jt={id:"modal-item-status",class:"text-capitalize"},qt={class:"col-md-12"},zt={class:"table"};function Gt(s,e,n,r,l,o){const Q=m("Link"),X=m("data-table"),Z=m("AppLayout");return i(),G(Z,null,{default:c(()=>{var p,h,b,_,f,g,v,y,k,w,S,x,A,C,L,M,N,R,I,D,F,P,E,T,U,V,B,J,O,Y,j,q;return[t("div",nt,[t("div",it,[t("div",rt,[t("div",ut,[e[4]||(e[4]=t("h5",null,"Leads",-1)),e[5]||(e[5]=t("p",null,"Manage Leads.",-1)),t("div",mt,[s.$root.hasPermission("lead.create")?(i(),G(Q,{key:0,class:"btn btn-main btn-sm",href:s.route("lead.create")},{default:c(()=>e[3]||(e[3]=[t("i",{class:"bx bx-plus"},null,-1),W(" Create ")])),_:1},8,["href"])):tt("",!0)])]),t("div",ct,[et(X,{ref:"datatable",id:"mytable",url:s.route("lead.getdata"),columns:l.columns,columnDefs:l.columnDefs},{header:c(()=>[t("tr",null,[t("th",pt,[t("div",ht,[t("input",{type:"checkbox",class:"form-check-input",id:"selectAll",onClick:e[0]||(e[0]=a=>o.selectAll(a))}),e[6]||(e[6]=t("label",{class:"form-check-label",for:"selectAll"},null,-1))])]),e[7]||(e[7]=t("th",null,"Name",-1)),e[8]||(e[8]=t("th",null,"Email",-1)),e[9]||(e[9]=t("th",null,"Phone",-1)),e[10]||(e[10]=t("th",null,"Status",-1)),e[11]||(e[11]=t("th",null,"Action",-1))])]),_:1},8,["url","columns","columnDefs"])])])]),t("div",bt,[t("div",_t,[t("div",ft,[e[14]||(e[14]=t("div",{class:"modal-header px-3 pb-2"},[t("h5",{class:"modal-title",id:"exampleModalLabel2"},"Are You Sure?")],-1)),t("form",{id:"formAccountDelete",onSubmit:e[2]||(e[2]=st((...a)=>o.deleteSelectedItems&&o.deleteSelectedItems(...a),["prevent"]))},[e[13]||(e[13]=t("div",{class:"modal-body py-0 px-3"},[t("div",{class:"row"},[t("div",{class:"col mb-1"},[t("p",null,"Are you sure you want to delete?")])])],-1)),t("div",gt,[t("button",{type:"button",class:"btn btn-sm btn-label-secondary","data-bs-dismiss":"modal",onClick:e[1]||(e[1]=(...a)=>o.resetForm&&o.resetForm(...a))},"Close"),e[12]||(e[12]=t("button",{type:"submit",class:"btn btn-sm btn-primary"},"Yes",-1))])],32)])])]),t("div",vt,[t("div",yt,[t("div",kt,[e[31]||(e[31]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"viewModalLabel"},"Lead Details"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",wt,[t("div",St,[t("div",xt,[e[16]||(e[16]=t("p",null,[t("strong",null,"Vehicle List")],-1)),t("table",At,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Type"),t("th",null,"URL")])],-1)),t("tbody",null,[(i(!0),u(H,null,K((h=(p=l.lead_data)==null?void 0:p.lead)==null?void 0:h.vehicle_data,a=>(i(),u("tr",{key:a.vehicle_id},[t("td",null,d(a.name),1),t("td",null,d(a.type),1),t("td",null,[t("a",{href:a.url,target:"_blank"},"View Vehicle",8,Ct)])]))),128))])])]),e[28]||(e[28]=t("hr",null,null,-1)),t("div",Lt,[t("p",null,[e[17]||(e[17]=t("strong",null,"Name : ",-1)),t("span",Mt,d((_=(b=l.lead_data)==null?void 0:b.lead)==null?void 0:_.name),1)])]),t("div",Nt,[t("p",null,[e[18]||(e[18]=t("strong",null,"Email : ",-1)),t("span",$t,d((g=(f=l.lead_data)==null?void 0:f.lead)==null?void 0:g.email),1)])]),t("div",Rt,[t("p",null,[e[19]||(e[19]=t("strong",null,"Phone : ",-1)),t("span",It,d((y=(v=l.lead_data)==null?void 0:v.lead)==null?void 0:y.phone),1)])]),t("div",Dt,[t("p",null,[e[20]||(e[20]=t("strong",null,"Address : ",-1)),t("span",Ft,d((w=(k=l.lead_data)==null?void 0:k.lead)==null?void 0:w.address),1)])]),t("div",Pt,[t("p",null,[e[21]||(e[21]=t("strong",null,"Message : ",-1)),t("span",Et,d((x=(S=l.lead_data)==null?void 0:S.lead)==null?void 0:x.message),1)])]),t("div",Tt,[t("p",null,[e[22]||(e[22]=t("strong",null,"Purchase Time : ",-1)),t("span",Ut,d((C=(A=l.lead_data)==null?void 0:A.lead)==null?void 0:C.purchase_time),1)])]),t("div",Vt,[t("p",null,[e[23]||(e[23]=t("strong",null,"Payment Method : ",-1)),t("span",Bt,d((M=(L=l.lead_data)==null?void 0:L.lead)==null?void 0:M.payment_method),1)])]),e[29]||(e[29]=t("hr",null,null,-1)),t("div",Jt,[t("p",null,[e[24]||(e[24]=t("strong",null,"Dealer Name : ",-1)),t("span",Ot,d((R=(N=l.lead_data)==null?void 0:N.dealer)==null?void 0:R.name),1)])]),t("div",Yt,[t("p",null,[e[25]||(e[25]=t("strong",null,"Status : ",-1)),t("span",jt,d(((D=(I=l.lead_data)==null?void 0:I.lead)==null?void 0:D.status)==="pending"?"Pending":((P=(F=l.lead_data)==null?void 0:F.lead)==null?void 0:P.status)==="contacted"?"Client Contacted":((T=(E=l.lead_data)==null?void 0:E.lead)==null?void 0:T.status)==="negotiating"?"Negotiating":((V=(U=l.lead_data)==null?void 0:U.lead)==null?void 0:V.status)==="advance_paid"?"Advance Paid":((J=(B=l.lead_data)==null?void 0:B.lead)==null?void 0:J.status)==="awaiting_for_shipping"?"Awaiting for Shipping":((Y=(O=l.lead_data)==null?void 0:O.lead)==null?void 0:Y.status)==="cancelled"?"Cancelled":"Unknown Status"),1)])]),e[30]||(e[30]=t("hr",null,null,-1)),t("div",qt,[e[27]||(e[27]=t("p",null,[t("strong",null,"Status Updates")],-1)),t("table",zt,[e[26]||(e[26]=t("thead",null,[t("tr",null,[t("th",null,"Status"),t("th",null,"Time")])],-1)),t("tbody",null,[(i(!0),u(H,null,K((q=(j=l.lead_data)==null?void 0:j.lead)==null?void 0:q.status_data,a=>(i(),u("tr",{key:a.status},[t("td",null,d(a.status==="pending"?"Pending":a.status==="contacted"?"Client Contacted":a.status==="negotiating"?"Negotiating":a.status==="advance_paid"?"Advance Paid":a.status==="awaiting_for_shipping"?"Awaiting for Shipping":a.status==="cancelled"?"Cancelled":"Unknown Status"),1),t("td",null,d(a.changed_at),1)]))),128))])])])])]),e[32]||(e[32]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},[t("i",{class:"fas fa-times"}),W(" Close ")])],-1))])])])])]}),_:1})}const Zt=dt(ot,[["render",Gt]]);export{Zt as default};
