import{x as a,p as r,s as t,F as h,y as p,N as b,O as V,M as U,L as f,J as C,Q as y,Y as x,d as O,P as g,m as R,q as I,t as c,S as E}from"./index-BC79lHc5.js";import{S as T,A as F}from"./AppLayout-DiJY6Gaj.js";import{F as N}from"./FileInputComponent-BBLs8XKv.js";import{E as K}from"./Editor-CNk9j0HY.js";import{d as P}from"./index-C45j6faE.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const j={name:"MultiSelect",props:{modelValue:{type:Array,default:()=>[]},options:{type:Array,required:!0}},emits:["update:modelValue"],data(){return{search:"",isOpen:!1}},computed:{selected(){return this.modelValue},filteredOptions(){const i=this.search.toLowerCase();return this.options.filter(e=>e.name.toLowerCase().includes(i)).filter(e=>!this.selected.some(d=>d.id===e.id))}},methods:{openDropdown(){this.isOpen=!0},selectOption(i){this.$emit("update:modelValue",[...this.selected,i]),this.search="",this.isOpen=!1},removeTag(i){this.$emit("update:modelValue",this.selected.filter(e=>e.id!==i.id))},selectBySearch(){const i=this.filteredOptions.find(e=>e.name.toLowerCase()===this.search.toLowerCase());i&&this.selectOption(i)},closeOnOutside(i){this.$el.contains(i.target)||(this.isOpen=!1)}},mounted(){document.addEventListener("click",this.closeOnOutside)},beforeUnmount(){document.removeEventListener("click",this.closeOnOutside)}},q={class:"tags"},B=["onClick"],G=["placeholder"],J={key:0,class:"options-list"},W=["onClick"],H={key:0,class:"no-option"};function Y(i,e,d,S,o,l){return r(),a("div",{class:"multi-select",onClick:e[3]||(e[3]=C((...n)=>l.openDropdown&&l.openDropdown(...n),["stop"]))},[t("div",q,[(r(!0),a(b,null,V(l.selected,(n,k)=>(r(),a("span",{key:k,class:"tag"},[U(f(n.name)+" ",1),t("button",{type:"button",onClick:C(w=>l.removeTag(n),["stop"])},"×",8,B)]))),128)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>o.search=n),onInput:e[1]||(e[1]=(...n)=>l.openDropdown&&l.openDropdown(...n)),onKeydown:e[2]||(e[2]=x(C((...n)=>l.selectBySearch&&l.selectBySearch(...n),["prevent"]),["enter"])),placeholder:l.selected.length?"":"Type or select…",class:"input"},null,40,G),[[y,o.search]])]),o.isOpen?(r(),a("ul",J,[(r(!0),a(b,null,V(l.filteredOptions,(n,k)=>(r(),a("li",{key:n.id,onClick:w=>l.selectOption(n),class:"option"},f(n.name),9,W))),128)),l.filteredOptions.length===0?(r(),a("li",H,"No matches")):h("",!0)])):h("",!0)])}const z=A(j,[["render",Y],["__scopeId","data-v-3cf719e7"]]),Q={components:{Link:O.Link,AppLayout:F,FileInputComponent:N,MultiSelect:z,SelectInputComponentVue:T,Editor:K},props:{errors:Object,allRoles:Object,backendUser:Object,branches:Array,features:Array,service_types:Object,vehicle_manufacture:Object,vehicle:Object,type:Object,manufacture:Object,color:Object,model:Object,countries:Array},data(){return{fuelTypeOptions:[{id:"Diesel",name:"Diesel"},{id:"Petrol",name:"Petrol"},{id:"Hybrid",name:"Hybrid"},{id:"Electric",name:"Electric"}],apiKey:"4ueqybvvojou72t5k8dn775enh0tfchqobzfd9upg1ov5p11",form:O.useForm({id:"",vehicle_type:"",manufacture_name:"",model:"",seo_url:"",ex_color:"",in_color:"",features:[],year:"",chassis_no:"",seats:"",doors:"",passengers:"",engine_capacity:"",mileage:"",countries:"",fuel_efficiency:"",auction_grade:"",interior_condition:"",availability:"",vehicle_status:"",editorContent:"",featured:"",latest:"",status:"",vehicle_image:"",monthly_price:"",monthly_price_currency:"LKR",initial_payment:"",initial_payment_currency:"LKR",uploaded_Images:[],gradeSections:[{grade:"",engine_capacities:[""],transmission:"",drive_type:"",fuel_types:[],chassis_nos:[""],description:""}]})}},mounted(){if(!this.vehicle)return;this.form.id=this.vehicle.id,this.form.vehicle_type=JSON.parse(this.vehicle.vehicle_type_id||"[]"),this.form.manufacture_name=this.vehicle.manufacture_id,this.form.model=this.vehicle.vehicle_model_id,this.form.year=this.vehicle.year,this.form.availability=this.vehicle.availability,this.form.editorContent=this.vehicle.editorContent,this.form.featured=this.vehicle.featured,this.form.latest=this.vehicle.latest,this.form.status=this.vehicle.status,this.form.monthly_price=this.vehicle.monthly_price,this.form.monthly_price_currency=this.vehicle.monthly_price_currency||"LKR",this.form.initial_payment=this.vehicle.initial_payment,this.form.initial_payment_currency=this.vehicle.initial_payment_currency||"LKR",this.form.countries=JSON.parse(this.vehicle.countries||"[]");let i=Array.isArray(this.vehicle.grades)?this.vehicle.grades:JSON.parse(this.vehicle.grades||"[]");this.form.gradeSections=i.length?i:[{grade:"",engine_capacities:[""],transmission:"",drive_type:"",fuel_types:[],chassis_nos:[""],description:""}],this.vehicle.media&&this.vehicle.media.length&&this.vehicle.media.filter(e=>{var d;return((d=e.custom_properties)==null?void 0:d.type)==="vehicle_gallery"}).forEach(e=>{this.form.uploaded_Images.push({file:e,preview:e.original_url})})},watch:{"form.monthly_price_currency":{handler(i){this.form.initial_payment_currency=i}},"form.countries":{handler(i){console.log("Countries updated:",i)},immediate:!0}},computed:{countriesOptions(){return this.countries.map(i=>({id:i.id,name:i.name}))},Vehicle_Image(){if(this.vehicle&&this.vehicle.media.length>0){const i=this.vehicle.media.find(e=>{var d;return((d=e.custom_properties)==null?void 0:d.type)==="vehicle_main"});return i?i.original_url:""}return""},initialPaymentError(){const i=parseFloat(this.form.initial_payment)||0,e=parseFloat(this.form.monthly_price)||0;return i>e?"Initial payment cannot exceed Full Price":""}},methods:{addSection(){this.form.gradeSections.push({grade:"",engine_capacities:[""],transmission:"",drive_type:"",fuel_types:[],chassis_nos:[""],description:""})},removeSection(i){this.form.gradeSections.splice(i,1)},handleImageUpload(i){Array.from(i.target.files).forEach(d=>{if(d&&d.type.startsWith("image/")){const S=new FileReader;S.onload=o=>{this.form.uploaded_Images.push({file:d,preview:o.target.result})},S.readAsDataURL(d)}else console.error("Selected file is not an image:",d)})},removeUploadedImage(i){const e=this.form.uploaded_Images[i];e.file.original_url&&e.preview?P.Inertia.post(route("vehicle.image.remove"),{imageUrl:e.preview,product_id:this.vehicle.id},{onSuccess:()=>{this.form.uploaded_Images.splice(i,1)},onError:d=>{console.error("Error deleting image:",d)}}):this.form.uploaded_Images.splice(i,1)},getModels(){this.$inertia.reload({method:"POST",data:{_method:"GET",manufacture_id:this.form.manufacture_name}})},submit(){if(this.initialPaymentError)return;const i=this.form.gradeSections[0]||{};this.form.fuel_types=(i.fuel_types||[]).map(e=>e.id),this.form.transmission=i.transmission,this.form.drive_type=i.drive_type,this.form.fuel_types=i.fuel_types,this.form.description=i.description,this.form.post(this.vehicle?route("vehicle.update"):route("vehicle.store"),{onSuccess:()=>{this.form.reset(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully!")},onError:()=>{this.form.reset("password","password_confirmation"),this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong!")}})}}},X={class:"row"},Z={class:"card mb-4"},$={class:"card-body"},ee={class:"row"},te={class:"mb-3 col-md-6"},se={class:"mb-3 col-md-6"},oe={class:"mb-3 col-md-6"},ie={class:"mb-3 col-md-6"},le={class:"text-danger"},ne={class:"mb-3 col-md-6"},re={class:"mb-3 col-md-6"},ae={class:"input-group"},de={class:"dropdown"},me={class:"btn btn-outline-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ce={class:"dropdown-menu"},ue={class:"text-danger"},pe={class:"mb-3 col-md-11"},he={class:"card mb-4 border shadow-sm"},fe={class:"card-body"},_e={class:"mb-3"},ve={style:{}},ye={class:"d-flex"},be=["onUpdate:modelValue"],ge=["onClick"],Ve={class:"row"},Ce={class:"mb-3 col-md-6"},Se=["onUpdate:modelValue"],ke=["onClick"],we=["onClick"],Ue={class:"mb-3 col-md-6"},Oe=["onUpdate:modelValue"],Ie={class:"mb-3 col-md-6"},Ee=["onUpdate:modelValue"],Ae={class:"mb-3 col-md-6"},Le={class:"text-danger"},De={class:"mb-3 col-md-6"},Me=["onUpdate:modelValue"],xe=["onClick"],Re=["onClick"],Te={class:"mb-3 col-md-6"},Fe=["onUpdate:modelValue"],Ne={class:"mb-3 col-md-12"},Ke={class:"row"},Pe={class:"col-md-6"},je={class:"text-danger"},qe={class:"col-md-6"},Be={class:"mb-4",style:{padding:"0.79rem 1.125rem"}},Ge={class:"upload-button"},Je={class:"btn btn-outline-primary"},We={key:0,class:"image-upload-container mt-2"},He={class:"image-box"},Ye=["src"],ze=["onClick"],Qe={class:"mb-3 col-md-6"},Xe={class:"mt-2"},Ze=["disabled"];function $e(i,e,d,S,o,l){const n=g("SelectInputComponentVue"),k=g("MultiSelect"),w=g("Editor"),L=g("FileInputComponent"),D=g("Link"),M=g("AppLayout");return r(),R(M,null,{default:I(()=>[t("div",X,[t("div",Z,[e[35]||(e[35]=t("div",{class:"card-header pb-0"},[t("h5",null,"Vehicle Manufacture"),t("p",null,"Manage Vehicle Manufacture.")],-1)),e[36]||(e[36]=t("hr",null,null,-1)),t("div",$,[t("form",{id:"formAccountSettings",onSubmit:e[16]||(e[16]=C((...s)=>l.submit&&l.submit(...s),["prevent"]))},[t("div",ee,[t("div",te,[c(n,{class:"w-100",id:"vehicle_type",isMultiple:!0,label:"Vehicle type",modelValue:o.form.vehicle_type,"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.vehicle_type=s),options:d.type},null,8,["modelValue","options"])]),t("div",se,[c(n,{class:"w-100",id:"manufacture_name",label:"Manufacture Name",modelValue:o.form.manufacture_name,"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.manufacture_name=s),options:d.manufacture,onChange:l.getModels},null,8,["modelValue","options","onChange"])]),t("div",oe,[c(n,{class:"w-100",id:"model",label:"Model",modelValue:o.form.model,"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.model=s),options:d.model},null,8,["modelValue","options"])]),t("div",ie,[e[17]||(e[17]=t("label",{for:"year",class:"form-label"},"Year",-1)),p(t("input",{class:"form-control",type:"text",id:"year",name:"year","onUpdate:modelValue":e[3]||(e[3]=s=>o.form.year=s)},null,512),[[y,o.form.year]]),t("div",le,f(o.form.errors.year),1)]),t("div",ne,[c(n,{class:"w-100",id:"availability",label:"Availability",modelValue:o.form.availability,"onUpdate:modelValue":e[4]||(e[4]=s=>o.form.availability=s),error:o.form.errors.availability,options:[{id:"Available",name:"Available"},{id:"Arriving",name:"Arriving"},{id:"Sold",name:"Sold"}]},null,8,["modelValue","error"])]),t("div",re,[e[18]||(e[18]=t("label",{for:"monthly_price",class:"form-label"},"Price",-1)),t("div",ae,[t("div",de,[t("button",me,f(o.form.monthly_price_currency),1),t("ul",ce,[t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[5]||(e[5]=C(s=>o.form.monthly_price_currency="USD",["prevent"]))}," USD ")]),t("li",null,[t("a",{class:"dropdown-item",href:"#",onClick:e[6]||(e[6]=C(s=>o.form.monthly_price_currency="LKR",["prevent"]))}," LKR ")])])]),p(t("input",{class:"form-control",type:"text",id:"monthly_price",name:"monthly_price","onUpdate:modelValue":e[7]||(e[7]=s=>o.form.monthly_price=s),placeholder:"Amount"},null,512),[[y,o.form.monthly_price]])]),t("div",ue,f(o.form.errors.monthly_price),1)]),t("div",pe,[c(n,{id:"countries",label:"Countries",modelValue:o.form.countries,"onUpdate:modelValue":e[8]||(e[8]=s=>o.form.countries=s),options:l.countriesOptions,isMultiple:!0,isRequired:!0},null,8,["modelValue","options"])]),(r(!0),a(b,null,V(o.form.gradeSections,(s,_)=>(r(),a(b,{key:_},[e[28]||(e[28]=t("label",{class:"form-label"},"Grades",-1)),t("div",he,[t("div",fe,[t("div",_e,[e[19]||(e[19]=t("label",{class:"form-label font-medium font"},"Vehicle Grade",-1)),t("span",ve," – "+f(_+1),1),t("div",ye,[p(t("input",{"onUpdate:modelValue":m=>s.grade=m,class:"form-control me-2",placeholder:"e.g. GR SPORT 4WD 5SEATER"},null,8,be),[[y,s.grade]]),o.form.gradeSections.length>1?(r(),a("button",{key:0,type:"button",class:"btn btn-outline-danger me-2",onClick:m=>l.removeSection(_)},"−",8,ge)):h("",!0),_===o.form.gradeSections.length-1?(r(),a("button",{key:1,type:"button",class:"btn btn-outline-success",onClick:e[9]||(e[9]=(...m)=>l.addSection&&l.addSection(...m))},"+")):h("",!0)])]),t("div",Ve,[t("div",Ce,[e[20]||(e[20]=t("label",{class:"form-label"},"Engine CC",-1)),(r(!0),a(b,null,V(s.engine_capacities,(m,u)=>(r(),a("div",{key:u,class:"d-flex mb-2"},[p(t("input",{"onUpdate:modelValue":v=>s.engine_capacities[u]=v,class:"form-control me-2",placeholder:"e.g. 1200 CC"},null,8,Se),[[y,s.engine_capacities[u]]]),s.engine_capacities.length>1?(r(),a("button",{key:0,type:"button",class:"btn btn-outline-danger me-2",onClick:v=>s.engine_capacities.splice(u,1)},"−",8,ke)):h("",!0),u===s.engine_capacities.length-1?(r(),a("button",{key:1,type:"button",class:"btn btn-outline-success",onClick:v=>s.engine_capacities.push("")},"+",8,we)):h("",!0)]))),128))]),t("div",Ue,[e[22]||(e[22]=t("label",{class:"form-label"},"Transmission",-1)),p(t("select",{name:"transmission",id:"transmission","onUpdate:modelValue":m=>s.transmission=m,class:"form-select"},e[21]||(e[21]=[t("option",{value:"Auto"},"Auto",-1),t("option",{value:"Manual"},"Manual",-1),t("option",{value:"Triptonic"},"Triptonic",-1)]),8,Oe),[[E,s.transmission]])]),t("div",Ie,[e[24]||(e[24]=t("label",{class:"form-label"},"Drive Type",-1)),p(t("select",{name:"drive_type",id:"drive_type","onUpdate:modelValue":m=>s.drive_type=m,class:"form-select"},e[23]||(e[23]=[t("option",{value:"Right Side Driving"},"Right Side Driving",-1),t("option",{value:"Left Side Driving"},"Left Side Driving",-1)]),8,Ee),[[E,s.drive_type]])]),t("div",Ae,[e[25]||(e[25]=t("label",{class:"form-label"},"Fuel Types",-1)),c(k,{modelValue:s.fuel_types,"onUpdate:modelValue":m=>s.fuel_types=m,options:o.fuelTypeOptions},null,8,["modelValue","onUpdate:modelValue","options"]),t("div",Le,f(o.form.errors.fuel_types),1)]),t("div",De,[e[26]||(e[26]=t("label",{class:"form-label"},"Chassis Nos",-1)),(r(!0),a(b,null,V(s.chassis_nos,(m,u)=>(r(),a("div",{key:u,class:"d-flex mb-2"},[p(t("input",{"onUpdate:modelValue":v=>s.chassis_nos[u]=v,class:"form-control me-2",placeholder:"Chassis No"},null,8,Me),[[y,s.chassis_nos[u]]]),s.chassis_nos.length>1?(r(),a("button",{key:0,type:"button",class:"btn btn-outline-danger me-2",onClick:v=>s.chassis_nos.splice(u,1)},"−",8,xe)):h("",!0),u===s.chassis_nos.length-1?(r(),a("button",{key:1,type:"button",class:"btn btn-outline-success",onClick:v=>s.chassis_nos.push("")},"+",8,Re)):h("",!0)]))),128))]),t("div",Te,[e[27]||(e[27]=t("label",{for:"description",class:"form-label"},"Description",-1)),p(t("textarea",{id:"description",name:"description","onUpdate:modelValue":m=>s.description=m,class:"form-control",placeholder:"Enter short description"},null,8,Fe),[[y,s.description]])])])])])],64))),128)),t("div",null,[c(w,{modelValue:o.form.editorContent,"onUpdate:modelValue":e[10]||(e[10]=s=>o.form.editorContent=s),"api-key":o.apiKey,init:{plugins:"lists link image table code help wordcount"}},null,8,["modelValue","api-key"])]),t("div",Ne,[t("div",Ke,[t("div",Pe,[e[29]||(e[29]=t("label",{for:"image",class:"form-label me-3"},"Image",-1)),e[30]||(e[30]=t("br",null,null,-1)),c(L,{isRequired:!1,id:"vehicle_image",prvImage:l.Vehicle_Image,modelValue:o.form.vehicle_image,"onUpdate:modelValue":e[11]||(e[11]=s=>o.form.vehicle_image=s)},null,8,["prvImage","modelValue"]),t("div",je,f(o.form.errors.vehicle_image),1)]),t("div",qe,[t("div",Be,[e[33]||(e[33]=t("h6",null,"Gallery Images",-1)),t("div",Ge,[t("label",Je,[e[31]||(e[31]=U(" Upload Images ")),t("input",{type:"file",multiple:"",onChange:e[12]||(e[12]=(...s)=>l.handleImageUpload&&l.handleImageUpload(...s)),hidden:""},null,32)])]),o.form.uploaded_Images.length>0?(r(),a("div",We,[(r(!0),a(b,null,V(o.form.uploaded_Images,(s,_)=>(r(),a("div",{class:"",key:_},[t("div",He,[t("img",{src:s.preview,alt:"Uploaded Image",class:"img-fluid"},null,8,Ye),t("button",{type:"button",class:"remove-btn",onClick:m=>l.removeUploadedImage(_)},e[32]||(e[32]=[t("i",{class:"fas fa-times"},null,-1)]),8,ze)])]))),128))])):h("",!0)])])])]),t("div",Qe,[c(n,{id:"featured",label:"Is Featured",error:o.form.errors.featured,options:[{id:"1",name:"Enable"},{id:"0",name:"Disable"}],modelValue:o.form.featured,"onUpdate:modelValue":e[13]||(e[13]=s=>o.form.featured=s)},null,8,["error","modelValue"]),c(n,{id:"latest",label:"Is Latest",error:o.form.errors.latest,options:[{id:"1",name:"Enable"},{id:"0",name:"Disable"}],modelValue:o.form.latest,"onUpdate:modelValue":e[14]||(e[14]=s=>o.form.latest=s)},null,8,["error","modelValue"]),c(n,{id:"status",label:"status",error:o.form.errors.status,options:[{id:"1",name:"Active"},{id:"0",name:"Inactive"}],modelValue:o.form.status,"onUpdate:modelValue":e[15]||(e[15]=s=>o.form.status=s)},null,8,["error","modelValue"])])]),t("div",Xe,[t("button",{type:"submit",class:"btn btn-main me-2",disabled:o.form.processing},f(d.vehicle?"Update":"Save"),9,Ze),c(D,{class:"btn btn-outline-danger",href:i.route("vehicle_manufacture.index")},{default:I(()=>e[34]||(e[34]=[U("Cancel")])),_:1},8,["href"])])],32)])])])]),_:1})}const nt=A(Q,[["render",$e],["__scopeId","data-v-1fc3ea73"]]);export{nt as default};
