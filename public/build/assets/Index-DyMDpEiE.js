import{P as v,x as i,p as r,s as t,F as y,t as d,J as g,M as C,N as b,O as _,a as V,d as E,L as c}from"./index-BC79lHc5.js";import w from"./SelectInputComponent-ChkQodwG.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={components:{SelectInputComponent:w},data(){return{form:E.useForm({manufacturer:"",model:"",engine:"",chassis:"",grade:"",auctiongrade:""}),loading:!1,statistics:null}},computed:{isFormValid(){return this.form.manufacturer&&this.form.model&&this.form.engine}},mounted(){$("#manufacture, #model, #engine").on("select2:open",function(){setTimeout(function(){let s=document.querySelector(".select2-container--open .select2-search__field");s&&s.focus()},100)})},watch:{"form.manufacturer"(s,e){s!==e&&(this.form.model="",this.form.engine="")},"form.model"(s,e){s!==e&&(this.form.engine="")}},methods:{formatCurrency(s){return new Intl.NumberFormat("en-US",{style:"currency",currency:"JPY",minimumFractionDigits:0}).format(s)},onChangeField(){this.loading=!0,this.$inertia.reload({method:"POST",data:{...this.form,_method:"GET"},onSuccess:()=>this.loading=!1})},filterData(){const s={manufacturer:this.form.manufacturer,model:this.form.model,engine:this.form.engine,chassis:this.form.chassis,grade:this.form.grade,auctiongrade:this.form.auctiongrade};V.get(route("export.models"),{params:s,responseType:"blob"}).then(e=>{console.log(e);const u=new Blob([e.data],{type:e.headers["content-type"]}),m=document.createElement("a"),n=e.headers["content-disposition"];let l="download.xlsx";if(n&&n.indexOf("attachment")!==-1){const a=/filename="?(.+)"?/.exec(n);a!=null&&a[1]&&(l=a[1])}m.href=window.URL.createObjectURL(u),m.download=l,m.click(),window.URL.revokeObjectURL(m.href)}).catch(e=>{console.error("Download failed",e),alert("Download failed. Please try again.")})},viewData(){const s={manufacturer:this.form.manufacturer,model:this.form.model,engine:this.form.engine,chassis:this.form.chassis,grade:this.form.grade,auctiongrade:this.form.auctiongrade};V.get(route("view.stats"),{params:s}).then(e=>{this.statistics=e.data.statistics}).catch(e=>{console.error(e)})}}},D={class:"container py-5"},x={class:"row justify-content-center"},F={class:"col-lg-10"},k={key:0,class:"loader-wrapper"},M={key:1,class:"row g-4"},N={class:"col-md-4"},U={class:"col-md-4"},L={class:"col-md-4"},R={class:"col-md-4"},T={class:"col-md-4"},O={class:"col-md-4"},G={class:"col-md-6 d-flex justify-content-end"},I=["disabled"],P={class:"col-md-6 d-flex justify-content-start"},j=["disabled"],B={key:0,class:"col-lg-10 mt-5"},K={class:"table-responsive"},Y={class:"table table-bordered table-striped align-middle text-center"};function J(s,e,u,m,n,l){var f,p,h;const a=v("SelectInputComponent");return r(),i("section",D,[t("div",x,[e[13]||(e[13]=t("div",{class:"col-lg-10 text-center mb-5"},[t("h2",{class:"section-title"},"Export Vehicle Statistics"),t("p",{class:"section-description"}," Select the make, model, and engine size to generate and download the 2023 - 2025 auction statistics for your vehicle. ")],-1)),t("div",F,[n.loading?(r(),i("div",k,e[8]||(e[8]=[t("div",{class:"spinner"},null,-1)]))):(r(),i("div",M,[t("div",N,[d(a,{id:"manufacture",modelValue:n.form.manufacturer,"onUpdate:modelValue":e[0]||(e[0]=o=>n.form.manufacturer=o),placeholder:"Select Make",onChange:l.onChangeField,options:s.$page.props.manufactures.map(o=>({id:o.MARKA_NAME,name:o.MARKA_NAME})),class:"field-input"},null,8,["modelValue","onChange","options"])]),t("div",U,[d(a,{id:"model",modelValue:n.form.model,"onUpdate:modelValue":e[1]||(e[1]=o=>n.form.model=o),placeholder:"Select Model",onChange:l.onChangeField,options:s.$page.props.models.map(o=>({id:o.MODEL_NAME,name:o.MODEL_NAME})),class:"field-input"},null,8,["modelValue","onChange","options"])]),t("div",L,[d(a,{id:"engine",modelValue:n.form.engine,"onUpdate:modelValue":e[2]||(e[2]=o=>n.form.engine=o),placeholder:"Engine CC",options:s.$page.props.engineCapacity.map(o=>({id:o.ENG_V,name:o.ENG_V})),class:"field-input"},null,8,["modelValue","options"])]),t("div",R,[d(a,{id:"auctiongrade",modelValue:n.form.auctiongrade,"onUpdate:modelValue":e[3]||(e[3]=o=>n.form.auctiongrade=o),placeholder:"SELECT Auction Grade",onChange:l.onChangeField,options:[{id:null,name:"All"},...((f=s.$page.props.auctionGrades)==null?void 0:f.map(o=>({id:o.RATE,name:o.RATE})))||[]]},null,8,["modelValue","onChange","options"])]),t("div",T,[d(a,{id:"chassis",modelValue:n.form.chassis,"onUpdate:modelValue":e[4]||(e[4]=o=>n.form.chassis=o),placeholder:"SELECT CHASSIS ID",onChange:l.onChangeField,options:[{id:null,name:"All"},...((p=s.$page.props.chassisNumbers)==null?void 0:p.map(o=>({id:o.KUZOV,name:o.KUZOV})))||[]]},null,8,["modelValue","onChange","options"])]),t("div",O,[d(a,{id:"grads",modelValue:n.form.grade,"onUpdate:modelValue":e[5]||(e[5]=o=>n.form.grade=o),placeholder:"SELECT GRADE",onChange:l.onChangeField,options:[{id:null,name:"All"},...((h=s.$page.props.grades)==null?void 0:h.map(o=>({id:o.GRADE,name:o.GRADE})))||[]]},null,8,["modelValue","onChange","options"])]),t("div",G,[t("button",{class:"btn btn-search px-4 py-2",onClick:e[6]||(e[6]=g((...o)=>l.viewData&&l.viewData(...o),["prevent"])),disabled:!l.isFormValid},e[9]||(e[9]=[t("i",{class:"fa fa-eye me-2"},null,-1),C(" View Statistics ")]),8,I)]),t("div",P,[t("button",{class:"btn btn-search px-4 py-2",onClick:e[7]||(e[7]=g((...o)=>l.filterData&&l.filterData(...o),["prevent"])),disabled:!l.isFormValid},e[10]||(e[10]=[t("i",{class:"fa fa-download me-2"},null,-1),C(" Download Vehicle List ")]),8,j)])]))]),n.statistics&&n.statistics.length?(r(),i("div",B,[e[12]||(e[12]=t("h4",{class:"mb-4 text-center"},"Yearly Auction Statistics",-1)),t("div",K,[t("table",Y,[e[11]||(e[11]=t("thead",{class:"table-dark"},[t("tr",null,[t("th",null,"Year"),t("th",null,"Vehicle Count"),t("th",null,"Average Price (¥)"),t("th",null,"Min Price (¥)"),t("th",null,"Max Price (¥)")])],-1)),t("tbody",null,[(r(!0),i(b,null,_(n.statistics,o=>(r(),i("tr",{key:o.year},[t("td",null,c(o.year),1),t("td",null,c(o.vehicles),1),t("td",null,c(l.formatCurrency(o.average_finish_price)),1),t("td",null,c(l.formatCurrency(o.min_price)),1),t("td",null,c(l.formatCurrency(o.max_price)),1)]))),128))])])])])):y("",!0)])])}const H=A(S,[["render",J],["__scopeId","data-v-26fff78d"]]);export{H as default};
