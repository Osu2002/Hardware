import{d as v,P as c,m as y,p as u,q as g,s,J as C,t as f,F as V,x as b,y as i,Q as m,L as r,N as L,O as w,M as S}from"./index-BC79lHc5.js";import{S as k,A}from"./AppLayout-DiJY6Gaj.js";import{F as U}from"./FileInputComponent-BBLs8XKv.js";import{E as N}from"./Editor-CNk9j0HY.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C45j6faE.js";const M={components:{Link:v.Link,AppLayout:A,FileInputComponent:U,SelectInputComponentVue:k,Editor:N},props:{errors:Object,lead:Object,customers:Array},data(){return{apiKey:void 0,form:v.useForm({name:"",email:"",phone:"",purchase_time:"",address:"",message:"",payment_method:"",url:"",vehicles:[],vehicle:"",vehicle_id:"",customer_id:"",type:"",id:"",status:"pending"})}},watch:{"form.customer_id":function(l){this.updateCusData(l)}},mounted(){this.lead&&(this.form.id=this.lead.id,this.form.name=this.lead.name,this.form.email=this.lead.email,this.form.phone=this.lead.phone,this.form.purchase_time=this.lead.purchase_time,this.form.address=this.lead.address,this.form.message=this.lead.message,this.form.payment_method=this.lead.payment_method,this.form.vehicles=JSON.parse(this.lead.vehicle_data),this.form.customer_id=this.lead.customer_id,this.form.status=this.lead.status)},methods:{addVehicle(){this.form.vehicle&&(this.form.vehicles.push({name:this.form.vehicle,type:this.form.type,url:this.form.url,vehicle_id:this.form.vehicle_id}),this.form.url="",this.form.vehicle="",this.form.type="")},removeVehicle(l){this.form.vehicles.splice(l,1)},updateCusData(l){const e=this.customers.find(d=>d.id==l);e&&(this.form.name=e.name,this.form.email=e.email,this.form.phone=e.phone)},validateAndExtract(){const l=this.form.url.trim(),e=/^https:\/\/nikoba\.com\/view-details\/([^/]+)\/([^?]+)\?id=(\d+)$/,d=/^https:\/\/nikoba\.com\/auction\/([^/]+)\/([^?]+)\?id=([A-Za-z0-9]+)$/;let n;(n=l.match(e))?(this.form.vehicle=n[2].replace(/-/g," "),this.form.vehicle_id=n[3],this.form.type="local",this.form.errors.url=""):(n=l.match(d))?(this.form.vehicle=n[2].replace(/-/g," "),this.form.vehicle_id=n[3],this.form.type="auction",this.form.errors.url=""):(this.form.errors.url="Invalid URL format!",this.form.vehicle="",this.form.type="")},submit(){this.form.post(this.lead?route("lead.update"):route("lead.store"),{onSuccess:()=>{this.form.reset(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.form.reset("password","password_confirmation"),this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})}}},F={class:"row"},I={class:"card mb-4"},P={class:"card-body"},T={class:"row"},O={class:"row"},R={class:"mb-3 col-md-12"},W={class:"text-danger"},B={class:"mb-3 col-md-6"},D={class:"text-danger"},H={class:"mb-3 col-md-6"},j={class:"text-danger"},q={class:"mb-3 col-md-12"},J=["disabled"],z={key:0,class:"mb-3"},K={class:"table table-bordered"},Q=["onClick"],Z={class:"mb-3 col-md-6"},G={class:"mb-3 col-md-6"},X={class:"mb-3 col-md-6"},Y={class:"mb-3 col-md-12"},$={class:"mb-3 col-md-12"},ee={class:"mt-2"},se=["disabled"];function te(l,e,d,n,o,a){const p=c("SelectInputComponentVue"),_=c("Link"),x=c("AppLayout");return u(),y(x,null,{default:g(()=>[s("div",F,[s("div",I,[e[27]||(e[27]=s("div",{class:"card-header pb-0"},[s("h5",null,"Leads"),s("p",null,"Manage Leads.")],-1)),e[28]||(e[28]=s("hr",null,null,-1)),s("div",P,[s("form",{id:"formAccountSettings",onSubmit:e[14]||(e[14]=C((...t)=>a.submit&&a.submit(...t),["prevent"]))},[s("div",T,[s("div",null,[s("div",O,[s("div",R,[e[15]||(e[15]=s("label",{for:"url",class:"form-label"},"Vehicle URL",-1)),i(s("input",{class:"form-control",type:"text",id:"url",name:"url","onUpdate:modelValue":e[0]||(e[0]=t=>o.form.url=t)},null,512),[[m,o.form.url]]),s("button",{type:"button",class:"btn btn-primary mt-2",onClick:e[1]||(e[1]=(...t)=>a.validateAndExtract&&a.validateAndExtract(...t))}," Search "),s("div",W,r(o.form.errors.url),1)]),s("div",B,[e[16]||(e[16]=s("label",{for:"vehicle",class:"form-label"},"Vehicle",-1)),i(s("input",{class:"form-control",type:"text",id:"vehicle",name:"vehicle","onUpdate:modelValue":e[2]||(e[2]=t=>o.form.vehicle=t),disabled:""},null,512),[[m,o.form.vehicle]]),s("div",D,r(o.form.errors.vehicle),1)]),s("div",H,[e[17]||(e[17]=s("label",{for:"type",class:"form-label"},"Type",-1)),i(s("input",{class:"form-control",type:"text",id:"type",name:"type","onUpdate:modelValue":e[3]||(e[3]=t=>o.form.type=t),disabled:""},null,512),[[m,o.form.type]]),s("div",j,r(o.form.errors.type),1)]),s("div",q,[s("button",{type:"button",class:"btn btn-primary mt-2 w-100",onClick:e[4]||(e[4]=(...t)=>a.addVehicle&&a.addVehicle(...t)),disabled:!o.form.vehicle}," Add Vehicle ",8,J)])]),o.form.vehicles.length?(u(),b("div",z,[e[19]||(e[19]=s("h5",{class:"mt-3"},"Selected Vehicles",-1)),s("table",K,[e[18]||(e[18]=s("thead",null,[s("tr",null,[s("th",null,"#"),s("th",null,"Vehicle"),s("th",null,"Vehicle Id"),s("th",null,"Type"),s("th",null,"URL"),s("th",null,"Action")])],-1)),s("tbody",null,[(u(!0),b(L,null,w(o.form.vehicles,(t,h)=>(u(),b("tr",{key:h},[s("td",null,r(h+1),1),s("td",null,r(t.name),1),s("td",null,r(t.vehicle_id),1),s("td",null,r(t.type),1),s("td",null,r(t.url),1),s("td",null,[s("button",{class:"btn btn-danger btn-sm",onClick:oe=>a.removeVehicle(h)}," Remove ",8,Q)])]))),128))])])])):V("",!0)]),e[25]||(e[25]=s("hr",null,null,-1)),f(p,{id:"customer_id",label:"Search Customer",error:o.form.errors.customer_id,options:d.customers.map(t=>({id:t.id,name:`${t.phone} (${t.name?t.name:""}) (${t.email})`})),modelValue:o.form.customer_id,"onUpdate:modelValue":e[5]||(e[5]=t=>o.form.customer_id=t),isRequired:!1},null,8,["error","options","modelValue"]),s("div",Z,[e[20]||(e[20]=s("label",{for:"name",class:"form-label"},"Name",-1)),i(s("input",{class:"form-control",type:"text",id:"name",name:"name","onUpdate:modelValue":e[6]||(e[6]=t=>o.form.name=t)},null,512),[[m,o.form.name]])]),s("div",G,[e[21]||(e[21]=s("label",{for:"email",class:"form-label"},"Email",-1)),i(s("input",{class:"form-control",type:"email",id:"email",name:"email","onUpdate:modelValue":e[7]||(e[7]=t=>o.form.email=t)},null,512),[[m,o.form.email]])]),s("div",X,[e[22]||(e[22]=s("label",{for:"phone",class:"form-label"},"Phone",-1)),i(s("input",{class:"form-control",type:"text",id:"phone",name:"phone","onUpdate:modelValue":e[8]||(e[8]=t=>o.form.phone=t)},null,512),[[m,o.form.phone]])]),f(p,{id:"purchase_time",label:"Purchase Time",error:o.form.errors.purchase_time,options:[{id:"Immediately",name:"Immediately"},{id:"Next Week",name:"Next Week"},{id:"Two Weeks",name:"Two Weeks"},{id:"One Month",name:"One Month"},{id:"Not Sure",name:"Not Sure"}],modelValue:o.form.purchase_time,"onUpdate:modelValue":e[9]||(e[9]=t=>o.form.purchase_time=t)},null,8,["error","modelValue"]),s("div",Y,[e[23]||(e[23]=s("label",{for:"address",class:"form-label"},"Address",-1)),i(s("textarea",{class:"form-control",id:"address",rows:"3","onUpdate:modelValue":e[10]||(e[10]=t=>o.form.address=t)},null,512),[[m,o.form.address]])]),s("div",$,[e[24]||(e[24]=s("label",{for:"message",class:"form-label"},"Message",-1)),i(s("textarea",{class:"form-control",id:"message",rows:"3","onUpdate:modelValue":e[11]||(e[11]=t=>o.form.message=t)},null,512),[[m,o.form.message]])]),f(p,{id:"payment",label:"Payment Method",error:o.form.errors.payment_method,options:[{id:"Full Lease",name:"Full Lease"},{id:"Half Lease",name:"Half Lease"},{id:"Cash",name:"Cash"},{id:"Full Loan",name:"Full Loan"},{id:"Half Loan",name:"Half Loan"}],modelValue:o.form.payment_method,"onUpdate:modelValue":e[12]||(e[12]=t=>o.form.payment_method=t)},null,8,["error","modelValue"]),l.$page.props.user.roles[0].name=="Super Admin"?(u(),y(p,{key:0,id:"status",label:"Status",error:o.form.errors.status,options:[{id:"contacted",name:"Client Contacted"},{id:"negotiating",name:"Negotiating"},{id:"pending",name:"Pending"},{id:"advance_paid",name:"Advance Paid"},{id:"awaiting_for_shipping",name:"Awaiting for Shipping"},{id:"cancelled",name:"Cancelled"}],modelValue:o.form.status,"onUpdate:modelValue":e[13]||(e[13]=t=>o.form.status=t)},null,8,["error","modelValue"])):V("",!0)]),s("div",ee,[s("button",{type:"submit",class:"btn btn-main me-2",disabled:o.form.processing},r(d.lead?"Update":"Save"),9,se),f(_,{class:"btn btn-outline-danger",href:l.route("lead.index")},{default:g(()=>e[26]||(e[26]=[S("Cancel")])),_:1},8,["href"])])],32)])])])]),_:1})}const de=E(M,[["render",te],["__scopeId","data-v-2cdf473b"]]);export{de as default};
